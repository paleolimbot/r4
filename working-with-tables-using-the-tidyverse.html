<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>R in the CWRS</title>
  <meta name="description" content="A collection of R lessons for CWRS projects">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="R in the CWRS" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A collection of R lessons for CWRS projects" />
  <meta name="github-repo" content="paleolimbot/r4cwrs" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="R in the CWRS" />
  
  <meta name="twitter:description" content="A collection of R lessons for CWRS projects" />
  

<meta name="author" content="The R Programming Group at the CWRS">


<meta name="date" content="2017-08-27">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="basic-r.html">
<link rel="next" href="creating-visualizations-using-ggplot.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R for the CWRS</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="basic-r.html"><a href="basic-r.html"><i class="fa fa-check"></i><b>1</b> Basic R</a><ul>
<li class="chapter" data-level="1.1" data-path="basic-r.html"><a href="basic-r.html#prerequisites"><i class="fa fa-check"></i><b>1.1</b> Prerequisites</a></li>
<li class="chapter" data-level="1.2" data-path="basic-r.html"><a href="basic-r.html#expressions-and-variables"><i class="fa fa-check"></i><b>1.2</b> Expressions and Variables</a></li>
<li class="chapter" data-level="1.3" data-path="basic-r.html"><a href="basic-r.html#functions"><i class="fa fa-check"></i><b>1.3</b> Functions</a></li>
<li class="chapter" data-level="1.4" data-path="basic-r.html"><a href="basic-r.html#vectors"><i class="fa fa-check"></i><b>1.4</b> Vectors</a></li>
<li class="chapter" data-level="1.5" data-path="basic-r.html"><a href="basic-r.html#indexing"><i class="fa fa-check"></i><b>1.5</b> Indexing</a></li>
<li class="chapter" data-level="1.6" data-path="basic-r.html"><a href="basic-r.html#using-the-script-editor"><i class="fa fa-check"></i><b>1.6</b> Using the Script Editor</a></li>
<li class="chapter" data-level="1.7" data-path="basic-r.html"><a href="basic-r.html#excercises"><i class="fa fa-check"></i><b>1.7</b> Excercises</a></li>
<li class="chapter" data-level="1.8" data-path="basic-r.html"><a href="basic-r.html#summary"><i class="fa fa-check"></i><b>1.8</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="working-with-tables-using-the-tidyverse.html"><a href="working-with-tables-using-the-tidyverse.html"><i class="fa fa-check"></i><b>2</b> Working with Tables using the Tidyverse</a><ul>
<li class="chapter" data-level="2.1" data-path="working-with-tables-using-the-tidyverse.html"><a href="working-with-tables-using-the-tidyverse.html#prerequisites-1"><i class="fa fa-check"></i><b>2.1</b> Prerequisites</a></li>
<li class="chapter" data-level="2.2" data-path="working-with-tables-using-the-tidyverse.html"><a href="working-with-tables-using-the-tidyverse.html#viewing-a-data-frame"><i class="fa fa-check"></i><b>2.2</b> Viewing a Data Frame</a></li>
<li class="chapter" data-level="2.3" data-path="working-with-tables-using-the-tidyverse.html"><a href="working-with-tables-using-the-tidyverse.html#selecting-columns"><i class="fa fa-check"></i><b>2.3</b> Selecting Columns</a><ul>
<li class="chapter" data-level="2.3.1" data-path="working-with-tables-using-the-tidyverse.html"><a href="working-with-tables-using-the-tidyverse.html#excercises-1"><i class="fa fa-check"></i><b>2.3.1</b> Excercises</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="working-with-tables-using-the-tidyverse.html"><a href="working-with-tables-using-the-tidyverse.html#filtering-rows"><i class="fa fa-check"></i><b>2.4</b> Filtering Rows</a><ul>
<li class="chapter" data-level="2.4.1" data-path="working-with-tables-using-the-tidyverse.html"><a href="working-with-tables-using-the-tidyverse.html#exercises"><i class="fa fa-check"></i><b>2.4.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="working-with-tables-using-the-tidyverse.html"><a href="working-with-tables-using-the-tidyverse.html#selecting-and-filtering"><i class="fa fa-check"></i><b>2.5</b> Selecting and Filtering</a><ul>
<li class="chapter" data-level="2.5.1" data-path="working-with-tables-using-the-tidyverse.html"><a href="working-with-tables-using-the-tidyverse.html#exercises-1"><i class="fa fa-check"></i><b>2.5.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="working-with-tables-using-the-tidyverse.html"><a href="working-with-tables-using-the-tidyverse.html#the-pipe"><i class="fa fa-check"></i><b>2.6</b> The Pipe (%&gt;%)</a><ul>
<li class="chapter" data-level="2.6.1" data-path="working-with-tables-using-the-tidyverse.html"><a href="working-with-tables-using-the-tidyverse.html#exercises-2"><i class="fa fa-check"></i><b>2.6.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="working-with-tables-using-the-tidyverse.html"><a href="working-with-tables-using-the-tidyverse.html#summarising-a-data-frame"><i class="fa fa-check"></i><b>2.7</b> Summarising A Data Frame</a></li>
<li class="chapter" data-level="2.8" data-path="working-with-tables-using-the-tidyverse.html"><a href="working-with-tables-using-the-tidyverse.html#excercises-2"><i class="fa fa-check"></i><b>2.8</b> Excercises</a></li>
<li class="chapter" data-level="2.9" data-path="working-with-tables-using-the-tidyverse.html"><a href="working-with-tables-using-the-tidyverse.html#summary-1"><i class="fa fa-check"></i><b>2.9</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="creating-visualizations-using-ggplot.html"><a href="creating-visualizations-using-ggplot.html"><i class="fa fa-check"></i><b>3</b> Creating Visualizations using ggplot</a><ul>
<li class="chapter" data-level="3.1" data-path="creating-visualizations-using-ggplot.html"><a href="creating-visualizations-using-ggplot.html#prerequisites-2"><i class="fa fa-check"></i><b>3.1</b> Prerequisites</a></li>
<li class="chapter" data-level="3.2" data-path="creating-visualizations-using-ggplot.html"><a href="creating-visualizations-using-ggplot.html#using-ggplot"><i class="fa fa-check"></i><b>3.2</b> Using ggplot</a></li>
<li class="chapter" data-level="3.3" data-path="creating-visualizations-using-ggplot.html"><a href="creating-visualizations-using-ggplot.html#summary-2"><i class="fa fa-check"></i><b>3.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="preparing-and-loading-your-data-into-r.html"><a href="preparing-and-loading-your-data-into-r.html"><i class="fa fa-check"></i><b>4</b> Preparing and Loading your data into R</a><ul>
<li class="chapter" data-level="4.1" data-path="preparing-and-loading-your-data-into-r.html"><a href="preparing-and-loading-your-data-into-r.html#prerequisites-3"><i class="fa fa-check"></i><b>4.1</b> Prerequisites</a></li>
<li class="chapter" data-level="4.2" data-path="preparing-and-loading-your-data-into-r.html"><a href="preparing-and-loading-your-data-into-r.html#preparing-data"><i class="fa fa-check"></i><b>4.2</b> Preparing data</a></li>
<li class="chapter" data-level="4.3" data-path="preparing-and-loading-your-data-into-r.html"><a href="preparing-and-loading-your-data-into-r.html#loading-data"><i class="fa fa-check"></i><b>4.3</b> Loading data</a></li>
<li class="chapter" data-level="4.4" data-path="preparing-and-loading-your-data-into-r.html"><a href="preparing-and-loading-your-data-into-r.html#cleaning-data"><i class="fa fa-check"></i><b>4.4</b> Cleaning data</a></li>
<li class="chapter" data-level="4.5" data-path="preparing-and-loading-your-data-into-r.html"><a href="preparing-and-loading-your-data-into-r.html#summary-3"><i class="fa fa-check"></i><b>4.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="using-rstudio-projects.html"><a href="using-rstudio-projects.html"><i class="fa fa-check"></i><b>5</b> Using RStudio Projects</a><ul>
<li class="chapter" data-level="5.1" data-path="using-rstudio-projects.html"><a href="using-rstudio-projects.html#prerequisites-4"><i class="fa fa-check"></i><b>5.1</b> Prerequisites</a></li>
<li class="chapter" data-level="5.2" data-path="using-rstudio-projects.html"><a href="using-rstudio-projects.html#projects"><i class="fa fa-check"></i><b>5.2</b> Projects</a></li>
<li class="chapter" data-level="5.3" data-path="using-rstudio-projects.html"><a href="using-rstudio-projects.html#creating-a-new-project"><i class="fa fa-check"></i><b>5.3</b> Creating a new project</a></li>
<li class="chapter" data-level="5.4" data-path="using-rstudio-projects.html"><a href="using-rstudio-projects.html#organizing-a-project"><i class="fa fa-check"></i><b>5.4</b> Organizing a project</a></li>
<li class="chapter" data-level="5.5" data-path="using-rstudio-projects.html"><a href="using-rstudio-projects.html#why-use-a-project"><i class="fa fa-check"></i><b>5.5</b> Why use a project?</a></li>
<li class="chapter" data-level="5.6" data-path="using-rstudio-projects.html"><a href="using-rstudio-projects.html#summary-4"><i class="fa fa-check"></i><b>5.6</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="computing-statistics-in-r.html"><a href="computing-statistics-in-r.html"><i class="fa fa-check"></i><b>6</b> Computing statistics in R</a><ul>
<li class="chapter" data-level="6.1" data-path="computing-statistics-in-r.html"><a href="computing-statistics-in-r.html#prerequisites-5"><i class="fa fa-check"></i><b>6.1</b> Prerequisites</a></li>
<li class="chapter" data-level="6.2" data-path="computing-statistics-in-r.html"><a href="computing-statistics-in-r.html#preparing-data-1"><i class="fa fa-check"></i><b>6.2</b> Preparing data</a></li>
<li class="chapter" data-level="6.3" data-path="computing-statistics-in-r.html"><a href="computing-statistics-in-r.html#loading-data-1"><i class="fa fa-check"></i><b>6.3</b> Loading data</a></li>
<li class="chapter" data-level="6.4" data-path="computing-statistics-in-r.html"><a href="computing-statistics-in-r.html#cleaning-data-1"><i class="fa fa-check"></i><b>6.4</b> Cleaning data</a></li>
<li class="chapter" data-level="6.5" data-path="computing-statistics-in-r.html"><a href="computing-statistics-in-r.html#summary-5"><i class="fa fa-check"></i><b>6.5</b> Summary</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R in the CWRS</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="working-with-tables-using-the-tidyverse" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Working with Tables using the Tidyverse</h1>
<p>In this tutorial we will introduce the <strong>data frame</strong>, or the object type that R uses to store tables. Most of the data you will work with in R can be represented by a table (think an excel sheet), and one of the main advantages of using R is that the data frame is a powerful and intuitive interface for tabular data. In this tutorial we will use the <a href="http://www.tidyverse.org/">tidyverse</a> to manipulate and summarise tabular data. The tutorial is a companion to the <a href="http://r4ds.had.co.nz/transform.html">Data transformation</a> chapter in <a href="http://r4ds.had.co.nz/">R for Data Science</a>.</p>
<div id="prerequisites-1" class="section level2">
<h2><span class="header-section-number">2.1</span> Prerequisites</h2>
<p>The prerequisites for this tutorial are <code>tidyverse</code> and <code>rclimateca</code>. If these packages aren’t installed, you’ll have to install them using <code>install.packages()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)
<span class="kw">install.packages</span>(<span class="st">&quot;rclimateca&quot;</span>)</code></pre></div>
<p>Load the packages when you’re done! If there are errors, you may have not installed the above packages correctly!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)</code></pre></div>
<pre><code>## Loading tidyverse: ggplot2
## Loading tidyverse: tibble
## Loading tidyverse: tidyr
## Loading tidyverse: readr
## Loading tidyverse: purrr
## Loading tidyverse: dplyr</code></pre>
<pre><code>## Conflicts with tidy packages ----------------------------------------------</code></pre>
<pre><code>## filter(): dplyr, stats
## lag():    dplyr, stats</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rclimateca)</code></pre></div>
<p>Finally, you will need to obtain the sample data using the <code>getClimateData()</code> function in the <strong>rclimateca</strong> package. Copy/paste the statement below to load the sample data for this tutorial.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">climate_data &lt;-<span class="st"> </span><span class="kw">getClimateData</span>(<span class="kw">c</span>(<span class="dv">27141</span>, <span class="dv">6354</span>), <span class="dt">nicenames =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>It’s worth mentioning a little bit about what this data frame contains, since we’ll be working with it for the rest of this tutorial. Each row contains a number of parameters that are available on a monthly basis from two Environment Canada climate stations (Kentville Agricultural Research Station is 27141; Greenwood Station is 6354). The <code>stationid</code> column identifies where the values were measured, the <code>year</code> and <code>month</code> column identify when the values were measured, and the rest of the columns contain the measured values. For each measured value column, there is a <code>flag</code> column that gives additional information about the measurement (for the most part, we will ignore these columns). The only column names that are slightly cryptic are <code>extrmaxtemp</code> and <code>extrmintemp</code>, which are the extreme maximum and minimum temperatures measured in that month, respectively.</p>
</div>
<div id="viewing-a-data-frame" class="section level2">
<h2><span class="header-section-number">2.2</span> Viewing a Data Frame</h2>
<p>The variable we have just created (<code>climate_data</code>) is a <strong>data frame</strong>, which is a table of values much like you would find in a spreadsheet. Each column in the data frame represents a variable (in this case, the year and month where each observation was measured, the mean temperature, total precipitation, and many others), and each row in the table represents an observation (for example, the mean temperature and total precipitation in May of 1999 at Greenwood).</p>
<p>In RStudio’s “Environment” tab (usually at the top right of the screen), you should see a variable called <code>climate_data</code> in the list. You can inspect it by clicking on the variable name, after which a tab will appear displaying the contents of the variable you just loaded. Clicking the little arrow to the left of the name will display the structure of the data frame, including the column names and some sample values. You can also do both of these things using the R commands <code>View()</code> and <code>str()</code>, respectively. Also useful is the <code>head()</code> function, which will display the first few rows of a data frame.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">View</span>(climate_data) <span class="co"># will display a graphic table browser</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(climate_data) <span class="co"># will display a text summary of the object</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    997 obs. of  27 variables:
##  $ stationid          : num  27141 27141 27141 27141 27141 ...
##  $ datetime           : chr  &quot;1996-07&quot; &quot;1996-08&quot; &quot;1996-09&quot; &quot;1996-10&quot; ...
##  $ year               : int  1996 1996 1996 1996 1996 1996 1997 1997 1997 1997 ...
##  $ month              : int  7 8 9 10 11 12 1 2 3 4 ...
##  $ meanmaxtemp        : num  23.8 24.8 18.8 12.3 6.1 4.8 -0.8 -0.2 1.1 7.1 ...
##  $ meanmaxtempflag    : chr  &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; ...
##  $ meanmintemp        : num  14.4 13.8 11.3 3.7 0 -1.9 -9.5 -8.4 -6.9 -1.2 ...
##  $ meanmintempflag    : chr  &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; ...
##  $ meantemp           : num  19.1 19.4 15.1 8 3 1.5 -5.2 -4.3 -2.9 2.9 ...
##  $ meantempflag       : chr  &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; ...
##  $ extrmaxtemp        : num  29.6 31.6 27.6 20.4 19 15.5 10.9 10.6 10 14.4 ...
##  $ extrmaxtempflag    : chr  &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; ...
##  $ extrmintemp        : num  10.7 8.5 3.7 -1.7 -8.7 -15.7 -20.9 -17.1 -17 -11.7 ...
##  $ extrmintempflag    : chr  &quot;S&quot; &quot;&quot; &quot;&quot; &quot;&quot; ...
##  $ totalrain          : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ totalrainflag      : chr  NA NA NA NA ...
##  $ totalsnow          : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ totalsnowflag      : chr  NA NA NA NA ...
##  $ totalprecip        : num  147.5 24.4 260.7 95.5 91.3 ...
##  $ totalprecipflag    : chr  &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; ...
##  $ snowgrndlastday    : int  0 0 0 0 NA 0 2 4 11 0 ...
##  $ snowgrndlastdayflag: chr  &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; ...
##  $ dirofmaxgust       : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ dirofmaxgustflag   : chr  NA NA NA NA ...
##  $ spdofmaxgust       : chr  NA NA NA NA ...
##  $ spdofmaxgustflag   : chr  NA NA NA NA ...
##  $ parseddate         : Date, format: &quot;1996-07-01&quot; &quot;1996-08-01&quot; ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(climate_data)</code></pre></div>
<pre><code>## # A tibble: 6 x 27
##   stationid datetime  year month meanmaxtemp meanmaxtempflag meanmintemp
## *     &lt;dbl&gt;    &lt;chr&gt; &lt;int&gt; &lt;int&gt;       &lt;dbl&gt;           &lt;chr&gt;       &lt;dbl&gt;
## 1     27141  1996-07  1996     7        23.8                        14.4
## 2     27141  1996-08  1996     8        24.8                        13.8
## 3     27141  1996-09  1996     9        18.8                        11.3
## 4     27141  1996-10  1996    10        12.3                         3.7
## 5     27141  1996-11  1996    11         6.1                         0.0
## 6     27141  1996-12  1996    12         4.8                        -1.9
## # ... with 20 more variables: meanmintempflag &lt;chr&gt;, meantemp &lt;dbl&gt;,
## #   meantempflag &lt;chr&gt;, extrmaxtemp &lt;dbl&gt;, extrmaxtempflag &lt;chr&gt;,
## #   extrmintemp &lt;dbl&gt;, extrmintempflag &lt;chr&gt;, totalrain &lt;dbl&gt;,
## #   totalrainflag &lt;chr&gt;, totalsnow &lt;dbl&gt;, totalsnowflag &lt;chr&gt;,
## #   totalprecip &lt;dbl&gt;, totalprecipflag &lt;chr&gt;, snowgrndlastday &lt;int&gt;,
## #   snowgrndlastdayflag &lt;chr&gt;, dirofmaxgust &lt;int&gt;, dirofmaxgustflag &lt;chr&gt;,
## #   spdofmaxgust &lt;chr&gt;, spdofmaxgustflag &lt;chr&gt;, parseddate &lt;date&gt;</code></pre>
</div>
<div id="selecting-columns" class="section level2">
<h2><span class="header-section-number">2.3</span> Selecting Columns</h2>
<p>One way to subset <code>climate_data</code> is to subset by column, for which we will use the <code>select()</code> function. For example, we may only be interested in the mean temperature information, represented by the columns <code>stationid</code>, <code>year</code>, <code>month</code>, and <code>meantemp</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mean_temp_data &lt;-<span class="st"> </span><span class="kw">select</span>(climate_data, stationid, year, month, meantemp)</code></pre></div>
<p>The first argument to the <code>select()</code> function is the original data frame (in this case, <code>climate_data</code>), and the remaining arguments are the names of the columns to be selected. To select the <code>stationid</code>, <code>year</code>, <code>month</code>, <code>meantemp</code> and <code>totalprecip</code> columns, you would use the following R command:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">temp_precip_data &lt;-<span class="st"> </span><span class="kw">select</span>(climate_data, stationid, year, month, meantemp, totalprecip)</code></pre></div>
<div id="excercises-1" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Excercises</h3>
<ul>
<li>Use <code>View()</code>, <code>str()</code>, and <code>head()</code> to preview the two data frames we just created. Do they have the columns you would expect?</li>
<li>Use <code>select()</code> to select <code>stationid</code>, <code>year</code>, <code>month</code>, and all of the columns containing temperature values, and assign it to the variable <code>temp_data</code>.</li>
</ul>
</div>
</div>
<div id="filtering-rows" class="section level2">
<h2><span class="header-section-number">2.4</span> Filtering Rows</h2>
<p>Another way to subset <code>climate_data</code> is by filtering rows using column values, similar to the filter feature in Microsoft Excel. This is done using the <code>filter()</code> function. For example, we may only be interested in July temperature for the two stations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">july_data &lt;-<span class="st"> </span><span class="kw">filter</span>(climate_data, month ==<span class="st"> </span><span class="dv">7</span>)</code></pre></div>
<p>Just like <code>select()</code>, the first argument to <code>filter()</code> is the original data frame, and the subsequent arguments are the conditions that each row must satisfy in order to be included in the output. Column values are referred to by the column name (in the above example, <code>month</code>), so to include all rows where the value in the <code>month</code> column is 7, we use <code>month == 7</code>. Passing multiple conditions means each row must satisfy all of the conditions, such that to obtain the data for July of 1999, we can use the following call to <code>filter()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">july_1999_data &lt;-<span class="st"> </span><span class="kw">filter</span>(climate_data, month ==<span class="st"> </span><span class="dv">7</span>, year ==<span class="st"> </span><span class="dv">1999</span>)</code></pre></div>
<p>It is very important that there are two equals signs within <code>filter()</code>! The <code>==</code> operator tests for equality (e.g. <code>(2 + 2) == 4</code>), whereas the <code>=</code> operator assigns a value or passes a named argument to a function, which is not what you’re trying to do within <code>filter()</code>. Other common operators that are useful within filter are <code>!=</code> (not equal to), <code>&gt;</code> (greater than), <code>&lt;</code> (less than), <code>&gt;=</code> (greater than or equal to), <code>&lt;=</code> (less than or equal to), and <code>%in%</code> (tests if the value is one of several values). Using these, we could find out which observations had mean temperatures that were below freezing:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">freezing_observations &lt;-<span class="st"> </span><span class="kw">filter</span>(climate_data, meantemp &lt;<span class="st"> </span><span class="dv">0</span>)</code></pre></div>
<p>We could also find which observations occurred during the summer months (May, June, July, or August):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">summer_data &lt;-<span class="st"> </span><span class="kw">filter</span>(climate_data, month %in%<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>))</code></pre></div>
<div id="exercises" class="section level3">
<h3><span class="header-section-number">2.4.1</span> Exercises</h3>
<ul>
<li>Use <code>View()</code>, <code>str()</code>, and <code>head()</code> to preview the data frames we just created. Do they have the rows you would expect?</li>
<li>Use <code>filter()</code> to find observations from the month of December where the mean temperature was above freezing.</li>
<li>Are there any observations from the month of January where the mean temperature was below freezing?</li>
<li>Filter <code>climate_data</code> to include only observations from the months of December, January, February, and March and assign it to a variable name of your choosing.</li>
</ul>
</div>
</div>
<div id="selecting-and-filtering" class="section level2">
<h2><span class="header-section-number">2.5</span> Selecting and Filtering</h2>
<p>Often we need to use both <code>select()</code> and <code>filter()</code> to obtain the desired subset of a data frame. To do this, we need to pass the result of <code>select()</code> to <code>filter()</code>, or the result of <code>filter()</code> to select. For example, we could create a data frame of mean temperature observations from the month of July one of two ways (you’ll recall that we selected temperature columns in the data frame <code>mean_temp_data</code>, and we filtered for the month of July in the data frame <code>july_data</code>):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">july_temp &lt;-<span class="st"> </span><span class="kw">filter</span>(mean_temp_data, month ==<span class="st"> </span><span class="dv">7</span>)
july_temp2 &lt;-<span class="st"> </span><span class="kw">select</span>(july_data, stationid, year, month, meantemp)</code></pre></div>
<div id="exercises-1" class="section level3">
<h3><span class="header-section-number">2.5.1</span> Exercises</h3>
<ul>
<li>Inspect <code>july_temp</code> and <code>july_temp2</code> using <code>View()</code>, <code>str()</code>, and <code>head()</code>. Are they identical?</li>
<li>Create a data frame of July total precipitation data and give it a variable name of your choosing. Do this by using <code>select()</code> followed by <code>filter()</code>, then using <code>filter()</code> followed by <code>select()</code>. Inspect the output to ensure the data frames are identical.</li>
</ul>
</div>
</div>
<div id="the-pipe" class="section level2">
<h2><span class="header-section-number">2.6</span> The Pipe (%&gt;%)</h2>
<p>There is an easier way! Instead of creating intermediary variables every time we want to subset a data frame using <code>select()</code> and <code>filter()</code>, we can use the pipe operator (<code>%&gt;%</code>) to pass the result of one function call to another. Thus, creating our <code>july_temp</code> data frame from above becomes one line with one variable assignment instead of two.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">july_temp3 &lt;-<span class="st"> </span>climate_data %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(month ==<span class="st"> </span><span class="dv">7</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(stationid, year, month, meantemp)</code></pre></div>
<p>What <code>%&gt;%</code> does is pass the left side into the first argument of the function call on the right side. Thus, <code>filter(climate_data, month == 7)</code> becomes <code>climate_data %&gt;% filter(month ==7)</code>. When using the tidyverse family of packages, you should use the pipe as often as possible! It usually makes for more readable, less error-prone code, and reduces the number of temporary variables you create that clutter up your workspace. When using <code>filter()</code> and <code>select()</code> with other tidyverse manipulations like <code>arrange()</code>, <code>group_by()</code>, <code>summarise()</code>, and <code>mutate()</code>, the pipe becomes indispensable.</p>
<div id="exercises-2" class="section level3">
<h3><span class="header-section-number">2.6.1</span> Exercises</h3>
<ul>
<li>Inspect <code>july_temp3</code> to ensure it is identical to <code>july_temp</code>.</li>
<li>Create a data frame of July total precipitation data using <code>climate_data</code>, <code>filter()</code>, <code>select()</code>, and <code>%&gt;%</code>. Is it identical to the data frame you created in the exercise above?</li>
</ul>
</div>
</div>
<div id="summarising-a-data-frame" class="section level2">
<h2><span class="header-section-number">2.7</span> Summarising A Data Frame</h2>
<p>So far we have looked at subsets of <code>climate_data</code>, but what if we want yearly averages instead of monthly averages? Using the tidyverse, we can <code>group_by()</code> the <code>stationid</code> and <code>year</code> column, and <code>summarise()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">climate_data %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(stationid, year) %&gt;%
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean_temp =</span> <span class="kw">mean</span>(meantemp))</code></pre></div>
<pre><code>## # A tibble: 84 x 3
## # Groups:   stationid [?]
##    stationid  year mean_temp
##        &lt;dbl&gt; &lt;int&gt;     &lt;dbl&gt;
##  1      6354  1942        NA
##  2      6354  1943  6.150000
##  3      6354  1944  6.933333
##  4      6354  1945  6.800000
##  5      6354  1946  6.850000
##  6      6354  1947  7.425000
##  7      6354  1948  6.208333
##  8      6354  1949  7.883333
##  9      6354  1950  6.758333
## 10      6354  1951  7.983333
## # ... with 74 more rows</code></pre>
<p>Here <code>group_by()</code> gets a list of columns, for which each unique combination of values will get one row in the output. <code>summarise()</code> gets a list of expressions that are evaluated for every unique combination of values defined by <code>group_by()</code> (e.g., <code>mean_temp</code> is the <code>mean()</code> of the <code>meantemp</code> column for each station, for each year). Often, we want to include a number of summary columns in the output, which we can do by pasing more expressions to <code>summarise()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">climate_data %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(stationid, year) %&gt;%
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean_temp =</span> <span class="kw">mean</span>(meantemp), 
            <span class="dt">max_temp =</span> <span class="kw">max</span>(extrmaxtemp),
            <span class="dt">min_temp =</span> <span class="kw">min</span>(extrmintemp))</code></pre></div>
<pre><code>## # A tibble: 84 x 5
## # Groups:   stationid [?]
##    stationid  year mean_temp max_temp min_temp
##        &lt;dbl&gt; &lt;int&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
##  1      6354  1942        NA       NA       NA
##  2      6354  1943  6.150000     32.8    -27.8
##  3      6354  1944  6.933333     37.2    -21.7
##  4      6354  1945  6.800000     32.8    -21.7
##  5      6354  1946  6.850000     33.3    -25.6
##  6      6354  1947  7.425000     33.9    -26.1
##  7      6354  1948  6.208333     34.4    -30.0
##  8      6354  1949  7.883333     35.6    -21.7
##  9      6354  1950  6.758333     32.2    -25.0
## 10      6354  1951  7.983333     31.7    -26.7
## # ... with 74 more rows</code></pre>
<p>You will notice that in 1942 the mean temperature appears to be <code>NA</code>, or missing. This is because R propogates missing values unless you explicitly tell it not to. To fix this, you could replace <code>mean(meantemp)</code> with <code>mean(meantemp, na.rm = TRUE)</code>. Other useful functions to use inside <code>summarise()</code> include <code>mean()</code>, <code>median()</code>, <code>sd()</code>, <code>sum()</code>, <code>min()</code>, and <code>max()</code>. These all take a vector of values and produce a single aggregate value suitable for use in <code>summarise()</code>. One special function, <code>n()</code>, you can use (with no arguments) inside <code>summarise()</code> to tell you how many observations were aggregated to produce the values in that row.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">climate_data %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(stationid, year) %&gt;%
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean_temp =</span> <span class="kw">mean</span>(meantemp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), 
            <span class="dt">max_temp =</span> <span class="kw">max</span>(extrmaxtemp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">min_temp =</span> <span class="kw">min</span>(extrmintemp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), 
            <span class="dt">n =</span> <span class="kw">n</span>())</code></pre></div>
<pre><code>## # A tibble: 84 x 6
## # Groups:   stationid [?]
##    stationid  year mean_temp max_temp min_temp     n
##        &lt;dbl&gt; &lt;int&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;int&gt;
##  1      6354  1942 -1.700000     21.1    -21.1    12
##  2      6354  1943  6.150000     32.8    -27.8    12
##  3      6354  1944  6.933333     37.2    -21.7    12
##  4      6354  1945  6.800000     32.8    -21.7    12
##  5      6354  1946  6.850000     33.3    -25.6    12
##  6      6354  1947  7.425000     33.9    -26.1    12
##  7      6354  1948  6.208333     34.4    -30.0    12
##  8      6354  1949  7.883333     35.6    -21.7    12
##  9      6354  1950  6.758333     32.2    -25.0    12
## 10      6354  1951  7.983333     31.7    -26.7    12
## # ... with 74 more rows</code></pre>
<p>Unsurprisingly, there are twelve observations per year, since there are twelve rows (one per month) in our original data frame. It’s always a good idea to include <code>n()</code> inside <code>summarise()</code>, if nothing else as a check to make sure you’ve used <code>group_by()</code> with the correct columns.</p>
</div>
<div id="excercises-2" class="section level2">
<h2><span class="header-section-number">2.8</span> Excercises</h2>
<ul>
<li>Assign the data frame we just created to a variable, and inspect it using <code>View()</code> and <code>str()</code>. Which years were the warmest? Which years were the coldest?</li>
<li>Create a similar data frame to the one we just created but with precipitation. In which years did the most precipitation fall? (Hint: you will need to use the <code>sum()</code> function)</li>
<li>Most of the data are from Greenwood (<code>stationid</code> 6354), with fewer years from Kentville (<code>stationid</code> 27141). How many years are available for each station, and what is the range of years where data is available for each station? (Hint: you will need to <code>group_by(stationid)</code>)</li>
</ul>
</div>
<div id="summary-1" class="section level2">
<h2><span class="header-section-number">2.9</span> Summary</h2>
<p>In this tutorial we introduced the use of <code>select()</code>, <code>filter()</code> and the pipe (<code>%&gt;%</code>). We also used <code>group_by()</code> and <code>summarise()</code> to provide summary statistics from a data frame. These functions are the building blocks of other powerful tools in the tidyverse.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="basic-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="creating-visualizations-using-ggplot.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/paleolimbot/r4cwrs/edit/master/02-dplyr.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
